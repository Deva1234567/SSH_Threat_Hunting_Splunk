index=main sourcetype=secure_logs
| rex "^(?<ts>\d+\.\d+)\s+(?<uid>\S+)\s+(?<src_ip>\d{1,3}(?:\.\d{1,3}){3})\s+(?<src_port>\d+)\s+(?<dest_ip>\d{1,3}(?:\.\d{1,3}){3})\s+(?<dest_port>\d+)\s+(?<proto>\S+)\s+(?<direction>\S+)\s+(?<client>\S+)\s+(?<server>\S+)"
| where client!=server
| stats count by src_ip dest_ip client server
| sort - count
