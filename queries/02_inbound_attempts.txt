index=main sourcetype=secure_logs
| rex "^(?<ts>\d+\.\d+)\s+(?<uid>\S+)\s+(?<src_ip>\d{1,3}(?:\.\d{1,3}){3})\s+(?<src_port>\d+)\s+(?<dest_ip>\d{1,3}(?:\.\d{1,3}){3})\s+(?<dest_port>\d+)\s+(?<proto>\S+)\s+(?<direction>\S+)"
| where direction="INBOUND"
| stats count by src_ip dest_ip proto
| sort - count
